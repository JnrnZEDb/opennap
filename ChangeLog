Changes from 0.11
=================

added support for using poll() instead of select() on systems that support
it

server now prints "VERSION opennap <version>" as the first line of the MOTD.
it is intended that clients can use this information to enable optional
features that only work with this version of the server, but without
disturbing the official windows client

fixed bug in share_file() where the escaped filename was not inserted into
the db

fixed bug where the argument to the TYPE search parameter was not skipped

Changes from 0.10
=================
added max_connections config variable

rewrote i/o handling to avoid copying data by using a buffer list.

changed server->server compression to use a stream to compress the entire
session.

servers now negotiate the compression level upon connection

added support for searching the database using soundex hashes.  client
syntax in the 200 message is
	SOUNDEX CONTAINS "..."
each soundex word should be separated by a space inside the quotes.

search no longer returns matches for the user issuing the search

search should use <= and >= for AT MOST and AT LEAST

added support for sharing generic media types

fixes to compile under Red Hat Linux 6.0 (Alpha)

added -l option to opennap and metaserver to specify a specific ip to listen
on for incoming connections instead of any device

fixes to compile cleanly without debugging enabled (not recommended at this
point)

change_speed() needs to update the library table so that searches by speed
are correct after a user changes their line speed

Changes from 0.09
=================

added `max_user_channels' as a configuration option

added additional integrity checking to the validate_*() functions in
debug mode

server variables can be dynamically changed using the 810 client message
(colten edwards)

login() should ensure that the given speed is in the 0-10 range

search() was sending the host using %d instead of %lu

server_connect() should check the return from split_line() to get the number
of arguments

metaserver should write a \n after the ip:port

send_queued_data() should return without doing anything if there is no data
to send

added check for /dev/random and substitute simple random number generation
on systems without it

added support for the server version (801) client request

added support for the server reconfig (800) client request

added client_queue_length and server_queue_length config variables to tune the
maximum queue lengths allowed

fixed resume messages which used broken sequences %ul and %uh

added max_results server config variable to control the maximum number of
matches returned on a client search

added compressed data packet (10200) for sending compressed messages between
servers uzing LZ77 compression.  level of compression is controlled by
"compression_level" configuration variable.  since compression takes a lot
of cycles for short messages, the variable "compression_threshold" is used
to decide when to compress data, so that short messages go through without
compression

added upload request (607) handler required for downloading from users on
a remote server

if a 404 message is received from another server, it is sent to all mods+

fixed kill_user() so elites can kill other elites

enabled tcp keepalive messages for client connections

added max_shared config variable to control how many files a user is allowed
to share

(owner,filename) should be the primary key in the library table to avoid
duplicates from the same user.

Changes from 0.08
=================

added support for the data port error (626) command

added support for the change speed command (700)

added support for client initiated 214 stats request

configure will look for mysql in /usr/local as well as /usr

fixed server crash when a user had a hotlist

added addition debugging support for various structures

user and channel names are now case insensitive

internal library size is now stored in kilobytes to avoid rounding errors

endian checking was rewritten to be more portable

changed user levels to leech, user, moderator, admin, elite

added support for the wallop command (627)

added support for ban, unban and banlist (612, 614, 615, 616, 629)

mods see some additional information in whois

added client support for server linking/delinking (see README for numerics)

server now notifies clients when login() sets their userlevel

add_hotlist should immediately notify a client of a logged in user,
otherwise the client won't see them

clients may only join 5 channels at a time

added -s option to allow only privileged users to create channels

Changes from 0.07
=================

added support for the 218-221 numerics

DOS filenames need to be quoted when submitting sql queries

set SO_REUSEADDR on the main server socket

fixed off-by-1 error in patchnap.c

fixed downloads to follow the correct sequence.  server should not send the
204 message to the downloader until recieving the 608 response from the
uploader

added support for downloading from firewalled clients (500,501)

search patterns need to have %, ', _ and \ quoted in the SQL query

login() did not set the ->host field of the USER struct, so downloads
between machines would fail.

added 10013 message type for transmitting the ip address of locally
connected machines to peer servers

Changes from 0.06
=================

removed spynap and spyserv from build list.

included patchnap.c for patching the linux nap client

Changes from 0.05
=================

fixed assertion in add_array() when adding to an empty array

search strings now convert spaces to % for SQL queries to allow searching
for multiple words.

server was reporting total library size in MB, not GB

each connection now has its own input buffer, dynamically allocated, so that
we can use nonblocking read() calls

added support for change data port command (703)

Changes from 0.04
=================

added support for resume searches (215, 216-217)

Changes from 0.03
=================
added support for channel user list (825/830).

added support for ping/pong (751/752).

fixed broken channel list (618) message

added channel list terminator message (617)

Changes from 0.02
=================
added hotlist support.  clients can add entries with 207, and are notified
about users logging in or out (209/210).

added channel listing support (617/618)

added generic array maniuplation routines arrary_add/array_remove

Changes from 0.01
=================
send_cmd() modified to take the CONNECTION struct instead of a file descriptor

modified send_cmd() and pass_message() to call new function queue_data()
instead of write().  to avoid blocking on write() calls, the server now
queues all messages it has to send for one pass on the event loop.  after all
input has been processed, queued data is sent.  send_queued_data() takes note
of how much data was actually sent and saves the rest for the next event
loop.

the server now requires mutual authentication for establishing a
server<->server link.

changed authentication such that the server passwords never travel over the net
in the clear.  this will prevent bogus servers from trying to steal a server's
password.  instead, we use a scheme similar to apop where one server issues
a challenge for which the other use will hash their password with and send
back the hash value.  except in this case both parties generate a random
"nonce" value which seeds the hash.

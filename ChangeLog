2000-04-14  drscholl  <drscholl@users.sourceforge.net>

	* /cvsroot/opennap/opennap/level.c:
	allow users to demote their user level again

	* /cvsroot/opennap/opennap/level.c:
	fixed bug in new level() code where an elite could not set another elite to
	a lower level

	* /cvsroot/opennap/opennap/search.c:
	added "downloads" to the list of words to ignore on searches

2000-04-13  drscholl  <drscholl@users.sourceforge.net>

	* /cvsroot/opennap/opennap/README, /cvsroot/opennap/opennap/announce.c, /cvsroot/opennap/opennap/ban.c, /cvsroot/opennap/opennap/handler.c, /cvsroot/opennap/opennap/login.c, /cvsroot/opennap/opennap/opennap.h, /cvsroot/opennap/opennap/util.c:
	added remote_notify_mods() command to allow a server to broadcast a message
	to remote mods

	server will no longer delink when a bad command is received.

	user and host ban messages are now sent to all mods on all servers

	all mods+ are notified when a user fails to log in as a privileged user

	* /cvsroot/opennap/opennap/join.c, /cvsroot/opennap/opennap/level.c, /cvsroot/opennap/opennap/login.c:
	don't allow % in either nicknames or channel names for safety

	fixed bug in format for log() message in channel_level() when a user tries
	to set a channel to a level above their own

	fixed bug in level() where the notification about the level change was sent
	to the user who issued the change instead of the target user

	* /cvsroot/opennap/opennap/config.c, /cvsroot/opennap/opennap/login.c, /cvsroot/opennap/opennap/main.c, /cvsroot/opennap/opennap/opennap.h, /cvsroot/opennap/opennap/userdb.c:
	removed Check_Expire global variable

	added nick expiration to dump_userdb()

	* /cvsroot/opennap/opennap/ban.c, /cvsroot/opennap/opennap/level.c, /cvsroot/opennap/opennap/main.c, /cvsroot/opennap/opennap/search.c:
	allow the setuserlevel command to work when the user is registered but not
	logged in

	set SO_REUSEADDR on the stats port

2000-04-12  drscholl  <drscholl@users.sourceforge.net>

	* /cvsroot/opennap/opennap/search.c: added additional debugging checks

	* /cvsroot/opennap/opennap/remove_connection.c, /cvsroot/opennap/opennap/whois.c:
	hash_free() was not called to free a local user's list of files

	* /cvsroot/opennap/opennap/kick.c, /cvsroot/opennap/opennap/napster.txt:
	clear_channel() needs to be careful about walking the list of users in a
	channel since the call to part_channel() could free the current list pointer

	* /cvsroot/opennap/opennap/config.c, /cvsroot/opennap/opennap/handler.c, /cvsroot/opennap/opennap/main.c, /cvsroot/opennap/opennap/opennap.h, /cvsroot/opennap/opennap/sample.conf, /cvsroot/opennap/opennap/util.c:
	added max_command_length config var to control the max allowed length of a
	client command

	* /cvsroot/opennap/opennap/ban.c, /cvsroot/opennap/opennap/login.c, /cvsroot/opennap/opennap/muzzle.c, /cvsroot/opennap/opennap/unmuzzle.c, /cvsroot/opennap/opennap/whois.c:
	unban had a bug where it would tell you the ban was not found even if it
	was.

	muzzle and unmuzzle should optionally take a reason argument.

	whois should display Muzzled instead of Active for muzzled users

	* /cvsroot/opennap/opennap/config.c, /cvsroot/opennap/opennap/remove_connection.c, /cvsroot/opennap/opennap/sample.conf:
	no need to null out the uopt->files member in remove_connection()

	changed default value of collect_interval to 300

	added max_browse_result to sample.conf

2000-04-11  drscholl  <drscholl@users.sourceforge.net>

	* /cvsroot/opennap/opennap/change.c, /cvsroot/opennap/opennap/login.c, /cvsroot/opennap/opennap/search.c:
	the reason for a nuke is not required

	added 'home' to the list of words to ignore in searches

	* /cvsroot/opennap/opennap/opennap.h, /cvsroot/opennap/opennap/remove_file.c, /cvsroot/opennap/opennap/serverlib.c, /cvsroot/opennap/opennap/topic.c, /cvsroot/opennap/opennap/upload_complete.c, /cvsroot/opennap/opennap/userdb.c, /cvsroot/opennap/opennap/usermode.c, /cvsroot/opennap/opennap/whois.c, /cvsroot/opennap/opennap/add_file.c, /cvsroot/opennap/opennap/browse.c, /cvsroot/opennap/opennap/change.c, /cvsroot/opennap/opennap/download.c, /cvsroot/opennap/opennap/free_user.c, /cvsroot/opennap/opennap/level.c, /cvsroot/opennap/opennap/login.c:
	moved the list of shared files into the USEROPT struct since it only needs
	to be present for locally connected users

	change_pass(), alter_pass() and nuke() should releay the command to other
	servers before checking if the account is locally registered, since the
	userdb may not be entirely replicated

	userdb_dump() sould unlink() User_Db_Path before calling rename() since it
	causes an error under win32

	notify_mods() is called with new usermode TOPIC when a topic of a channel
	has been changed

	compacted whois() to use the same snprintf() call for level>=moderator

	* /cvsroot/opennap/opennap/change.c, /cvsroot/opennap/opennap/level.c, /cvsroot/opennap/opennap/login.c, /cvsroot/opennap/opennap/serverlib.c, /cvsroot/opennap/opennap/usermode.c:
	change_pass() and change_email() need to check for bad user input

	added include files to prevent compiler warnings

	* /cvsroot/opennap/opennap/login.c:
	register_user() did not call generate_pass() to generate the md5 password

	* /cvsroot/opennap/opennap/change.c:
	alter password command was sending the md5-hashed password instead of the
	raw password

	* /cvsroot/opennap/opennap/usermode.c:
	usermode.c needs stdio.h for snprintf()

	* /cvsroot/opennap/opennap/handler.c, /cvsroot/opennap/opennap/resume.c, /cvsroot/opennap/opennap/search.c:
	removed extraneous log messages

	ignore the word "download" in searches

2000-04-10  drscholl  <drscholl@users.sourceforge.net>

	* /cvsroot/opennap/opennap/search.c:
	added "download" to the list of words to ignore when searching

	* /cvsroot/opennap/opennap/search.c:
	added new words to ignore in the search table: scour, media, agent, on,
	stuff

	* /cvsroot/opennap/opennap/usermode.c:
	adding missing PORT string in User_Modes

	initial mode should be set from current user mode in user_mode()

	* /cvsroot/opennap/opennap/kick.c, /cvsroot/opennap/opennap/usermode.c:
	fixed compilation warnings for usermode code

	* /cvsroot/opennap/opennap/usermode.c:
	added new function handler user_mode()

	* /cvsroot/opennap/opennap/Makefile.in, /cvsroot/opennap/opennap/ban.c, /cvsroot/opennap/opennap/change.c, /cvsroot/opennap/opennap/download.c, /cvsroot/opennap/opennap/handler.c, /cvsroot/opennap/opennap/hotlist.c, /cvsroot/opennap/opennap/join.c, /cvsroot/opennap/opennap/kick.c, /cvsroot/opennap/opennap/kill_user.c, /cvsroot/opennap/opennap/level.c, /cvsroot/opennap/opennap/login.c, /cvsroot/opennap/opennap/muzzle.c, /cvsroot/opennap/opennap/opennap.h, /cvsroot/opennap/opennap/privmsg.c, /cvsroot/opennap/opennap/remove_connection.c, /cvsroot/opennap/opennap/server_connect.c, /cvsroot/opennap/opennap/server_login.c, /cvsroot/opennap/opennap/serverlib.c, /cvsroot/opennap/opennap/unmuzzle.c:
	patch from colten edwards to allow ircd-like user levels to enable or
	disable many server messages to privileged users

	* /cvsroot/opennap/opennap/ChangeLog, /cvsroot/opennap/opennap/NEWS, /cvsroot/opennap/opennap/sample.conf, /cvsroot/opennap/opennap/sample.users:
	final updates for 0.24 release

	* /cvsroot/opennap/opennap/README, /cvsroot/opennap/opennap/add_file.c, /cvsroot/opennap/opennap/search.c:
	ignore "2" in filenames since it is a frequent occurance

	* /cvsroot/opennap/opennap/free_user.c:
	update the last seen time for registered nicks when a user logs off

	* /cvsroot/opennap/opennap/login.c:
	server should send a KILL when it detects a remote user with an invalid
	nick

